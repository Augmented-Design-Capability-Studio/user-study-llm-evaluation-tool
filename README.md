# Bracket Design Assistant with LLM Evaluation

This project leverages the OpenAI GPT-4 API and Claude API to assist in evaluating user studies by generating questions and understanding based on transcripts. The goal is to compare the questions generated by the LLMs (Large Language Models) with those asked by a human during the study and to evaluate the LLMs' understanding of the design process.

## Features

- Reads transcription files with timestamps.
- Reads Wizard of Oz (WOZ) questions from a CSV file.
- Generates questions and summaries based on the transcription content using OpenAI's GPT-4 API or Claude API.
- Compares the generated questions with predefined WOZ questions to evaluate similarity and differences.
- Provides concise summaries of the user's progress and understanding.

## Prerequisites

- Node.js installed on your machine.
- An OpenAI API key.
- A Claude API key.

## Installation

1. Clone the repository:

   ```bash
   git clone https://github.com/yourusername/user-study-llm-evaluation-tool.git
   cd user-study-llm-evaluation-tool
   ```

2. Install the required dependencies:

   ```bash
   npm install
   ```

3. Create a `.env` file in the root directory and add your API keys:

   ```plaintext
   OPENAI_API_KEY=your_openai_api_key
   CLAUDE_API_KEY=your_claude_api_key
   ```

## Data Directory

The data directory includes folders for each user study.

```plaintext
data/
|——— P01/
|     |————openai/
|     |       |————pythia/
|     |       |————socratais/
|     |       |————hephaistus/
|     |————claude/
|     |       |————pythia/
|     |       |————socratais/
|     |       |————hephaistus/
|     |___ P01_meta.json
|     |___ P01_commands.sh
|     |___ P01_OriginalTranscript.srt
|     |___ P01_NoWizardTranscript.srt
|     |___ P01_WizardTranscript.srt
|     |___ P01_WizardQuestions.csv
```

The output CSVs should be in their respective folders: `pythia`, `socratais`, and `hephaistus`. They should include metadata at the top of their files:

Example:
```plaintext
Agent: pythia v1
Transcript: No Wizard
Screenshots: No Screenshots
Engine: OpenAI
```

### Transcription File (`transcription.srt`)

The transcription file should be in the following format:

```plaintext
1
00:00:00,000 --> 00:00:04,000
[silence]

2
00:00:04,000 --> 00:00:08,000
Hey Hannah, this is Frederik. Can you hear me?
...
```

### WOZ Questions File (`woz_questions.csv`)

The WOZ questions file should be in CSV format with the following structure:

```plaintext
video_time,message
00:00:37,"Hey!..... I am a voice agent here to support you during the design task.....I can hear what you are saying, and I can see your screen and follow along with you while you work on the task. Occasionally, I will ask you questions that are supposed to help you think through the design task."
00:01:32,Hey!..... What are you trying to do?
...
```

## Usage

To run the script and process the transcripts:

```bash
node index.js [FOLDER_NAME] [TRANSCRIPT] [SCREENSHOT] [ENGINE] [MODEL] [AGENT_SYSTEM_PROMPT]
```

The script will:
1. Read the transcription and WOZ questions files.
2. Use the OpenAI GPT API or Claude API to generate questions and summaries based on the transcription content.
3. Save the responses and generated questions in the `[date][engine][model][agent].csv` file.

## Example Output

### `[date][engine][model][agent].csv`

The CSV output should look something like this:

```plaintext
Agent;pythia
Version;v1
Model;4o
Times;Generated Responses;Understanding of Agent;Human Generated Responses
00:00:40,000;"Could you describe your project goals and provide some details on what you're aiming to design using Fusion 360's generative design function?";"It looks like you've successfully set up your Zoom recording and are ready to proceed with your design task in Fusion 360. Let's get started on determining the correct loads, manufacturing process, materials, and obstacle geometry for your project. How can I assist you with the first step?";"What is your main objective for this project, and what specific outcomes are you hoping to achieve using the generative design tools in Fusion 360?"
```

## Automating Data Collection

To automate the data collection for a user study, you can run the `P01_commands.sh` script located in the respective user study folder. This script will execute all necessary commands to process the data.

### Example

Navigate to the user study folder and run the `P01_commands.sh` script:

```bash
cd data/P01
./P01_commands.sh
```